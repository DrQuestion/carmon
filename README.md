
<!-- README.md is generated from README.Rmd. Please edit that file -->

# carmon - Copula Aided Reconstruction of Multi-Omics Networks

<!-- badges: start -->

<!-- badges: end -->

Carmon uses copula-based approaches to reconstruct multi-omics networks.
Copulae allow to maximize the use of the information contained in
non-normalized raw omics data, creating a mirror image in the normal
realm for each variable of every omics layer. Carmon then uses these
“mirror” normal variables to reconstruct the multi-omics network.

## Installation

You can install carmon from [Bioconductor](https://bioconductor.org/)
with:

``` r
if (!require("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("carmon")
```

## Usage

Here is an example of the typical usage of carmon to reconstruct a
multi-omics network. For a more customized use of the package, please
see `vignette("carmon")`. The main function of the package is
`carmon()`, a single wrapping function encompassing all the modules of
the package. Two are the minimal recommended arguments to use
`carmon()`. The first one is the input multi-omics data, and it is
mandatory. <!-- Check how to integrate MultiAssay class from Bioc -->  
It should be preferably provided in the form of an R list containing the
single omics layers separately. The function expects every layer to be
perfectly source-matched. This means that every variable of every layer
must have been measured for the same individuals/samples/replicates. The
second recommended argument is the `omics` argument, which espects a
vector with as many elements as the multi-omics layers to analyse. Each
element in the vector must correspond to the respective omics layer in
the input data, and it must define the omics type (*e.g.*
`omics = c("trancriptomics", "metabolomics")` in case of a multi-mics
dataset with this two kind of layers). In this example we use the small
dataset already provided by the package, `name_of_dataset`. It has two
layers, a xxx and a yy layer, of, respectively, nx genes and ny
metabolites. Most multi-omics datasets will not have the same omics
layer repeated twice. In that case, if the elements of the input list
with the multi-omics data are named as the values expected by the
argument `omics`, the `omics` argument is unnecessary. Since this is the
case with `name_of_dataset`, we omit the `omics` argument.

``` r
library(carmon)

# names(name_of_dataset)

# carmon_obj <- carmon(name_of_dataset)
```

This single call covers all functional modules of the package. It first
uses the tailored copula framework for the respective omics layers
(*e.g.*, expects gen counts of the transcriptomic data to be distributed
according to a Negative Binomial distribution, and it uses the
appropriate copula framework). It then builds the network with the
default network reconstruction method, *coglasso* ([Albanese, Kohlen and
Behrouzi, 2024](#references)), selecting the optimal one with the
default selection procedure, *XEStARS* in this case
([ibid.](#references)). Following the reconstruction, it runs a network
analysis module on the obtained network, identifying the key nodes
accoding to four different measures. Finally, it generates two plots:
the first one reporting the result of the network analysis, and the
second picturing the obtained network, highlighting the possible key
players. The report generated by the network analysis can be accessed
via:

``` r
# centrality_report(carmon_obj)
```

The report table contains the nodes that resulted to be central in the
analysis, accoridng to four different measures of centrality: degree
(d), betwenness (b), closeness (c), and eigenvalue (e) centrality. Names
that result central according to more than one measure are reported on
top of the table, and the column xxx contains the first letter of the
measure according to which they resulted to be central. In our
interpretation, the more measures label a node as central, the more
important this node is in the network.

## References

Albanese, A., Kohlen, W., & Behrouzi, P. (2024). Collaborative graphical
lasso (arXiv:2403.18602). *arXiv*
<https://doi.org/10.48550/arXiv.2403.18602>
