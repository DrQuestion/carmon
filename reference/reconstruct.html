<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Reconstruct a multi-omics network from a list of copulized layers — reconstruct • carmon</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Reconstruct a multi-omics network from a list of copulized layers — reconstruct"><meta property="og:description" content="Reconstruct a multi-omics network from a list of copulized layers with a
chosen network reconstruction method. The default method is
collaborative graphical regression."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">carmon</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/carmon.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/DrQuestion/carmon/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Reconstruct a multi-omics network from a list of copulized layers</h1>
    <small class="dont-index">Source: <a href="https://github.com/DrQuestion/carmon/blob/HEAD/R/reconstruct.R" class="external-link"><code>R/reconstruct.R</code></a></small>
    <div class="hidden name"><code>reconstruct.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Reconstruct a multi-omics network from a list of copulized layers with a
chosen network reconstruction method. The default method is
<em>collaborative graphical regression</em>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">reconstruct</span><span class="op">(</span></span>
<span>  <span class="va">layers</span>,</span>
<span>  net_method <span class="op">=</span> <span class="st">"coglasso"</span>,</span>
<span>  sel_method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  cor_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cor_quant <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  minimal_output <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-layers">layers<a class="anchor" aria-label="anchor" href="#arg-layers"></a></dt>
<dd><p>The omics layers to analyze. To be provided as a named R
list of data sets that have undergone the copulization treatment by the
<code><a href="copulize.html">copulize()</a></code> function. Given the output  of <code><a href="copulize.html">copulize()</a></code>, for example an
object named <code>carmon_cop</code>, it can be accessed via <code>carmon_cop$layers</code>.</p></dd>


<dt id="arg-net-method">net_method<a class="anchor" aria-label="anchor" href="#arg-net-method"></a></dt>
<dd><p>The network reconstruction method to use. The four methods
currently available are: 'coglasso' for collaborative graphical lasso,
'glasso' for graphical lasso, 'mb' for the Meinshausen-Buhlmann
neighborhood selection, and 'correlation' for a thresholded Pearson's
correlation network. The default method is 'coglasso'.</p></dd>


<dt id="arg-sel-method">sel_method<a class="anchor" aria-label="anchor" href="#arg-sel-method"></a></dt>
<dd><p>The network selection method. Each reconstruction procedure
has its own model selection procedures available. Here is the list of them:</p><ul><li><p>for <code>net_method</code> being 'coglasso': 'xstars' for eXtended StARS, 'xestars'
for eXtended  Efficient StARS, and 'ebic' for extended bayesian information
criterion. Default is 'xestars'.</p></li>
<li><p>for <code>net_method</code> being 'glasso': 'stars' for StARS, 'ric' for rotational
information criterion, and 'ebic' for for extended bayesian information
criterion. Default is 'stars'.</p></li>
<li><p>for <code>net_method</code> being 'mb' or 'correlation': 'stars' for StARS, 'ric'
for rotational information criterion. Default is 'stars'.</p></li>
</ul></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>The additional optional arguments to be given for the network
reconstruction procedure. The available arguments depend on the chosen
network reconstruction and network selection methods. If using 'coglasso'
(default option), see <code><a href="https://drquestion.github.io/coglasso/reference/bs.html" class="external-link">coglasso::bs()</a></code> for both reconstruction and
selection arguments. If reconstructing with 'glasso', 'mb', or
'correlation' without setting <code>cor_cutoff</code> or <code>cor_quant</code> see,
respectively, <code><a href="https://rdrr.io/pkg/huge/man/huge.glasso.html" class="external-link">huge::huge.glasso()</a></code>, <code><a href="https://rdrr.io/pkg/huge/man/huge.mb.html" class="external-link">huge::huge.mb()</a></code>, or
<code><a href="https://rdrr.io/pkg/huge/man/huge.ct.html" class="external-link">huge::huge.ct()</a></code>. For additional options for network selection from these
last three reconstruction methods, see <code><a href="https://rdrr.io/pkg/huge/man/huge.select.html" class="external-link">huge::huge.select()</a></code>.</p></dd>


<dt id="arg-cor-cutoff">cor_cutoff<a class="anchor" aria-label="anchor" href="#arg-cor-cutoff"></a></dt>
<dd><p>Optional for <code>net_method = 'correlation'</code>. The cutoff
value for the absolute Pearson's correlation network. Any edge with an
absolute correlation below the cutoff is excluded from the final network.
Not used by default, as the cutoff is generated by internal calculations.</p></dd>


<dt id="arg-cor-quant">cor_quant<a class="anchor" aria-label="anchor" href="#arg-cor-quant"></a></dt>
<dd><p>Optional for <code>net_method = 'correlation'</code>, to set as an
alternative to <code>cor_cutoff</code>. Determine the cutoff of correlation based on
the top percentile indicated by the user. For example, <code>cor_quant = 0.2</code>
would set as a correlation cutoff the 20th percentile of the absolute
Pearson's correlation values, ordered from highest to lowest. Not used by
default, as the cutoff is generated by internal calculations.</p></dd>


<dt id="arg-minimal-output">minimal_output<a class="anchor" aria-label="anchor" href="#arg-minimal-output"></a></dt>
<dd><p>Logical. Set to TRUE to get only a minimal output from
the <code>reconstruct()</code> function, which differs depending on the network
reconstruction method.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>The level of verbosity of the reconstruction process. <code>0</code>
suppresses the information output, while <code>1</code> and <code>2</code> give progressively
increasing amounts of information about the inner computations happening
inside <code>reconstruct()</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>reconstruct()</code> returns an object of <code>S3</code> class <code>carmon_rec</code>. The
elements it contains depend on the chosen network reconstruction and
selection strategies, but the main elements are shared by all methods. <br>
These shared elements are:</p><ul><li><p><code>sel_adj</code> is the adjacency matrix of the final selected network.</p></li>
<li><p><code>net_method</code> is the chosen network reconstruction method.</p></li>
<li><p><code>sel_method</code> is the chosen model selection method.</p></li>
<li><p><code>reconstruct_call</code> is the matched call.</p></li>
</ul><p>Moreover, when choosing 'coglasso' or 'glasso' as network reconstruction
method, <code>reconstruct()</code> also returns:</p>
<ul><li><p><code>sel_icov</code> is the inverse covariance matrix of the final selected
network.</p></li>
</ul><p>Otherwise, if choosing 'correlation', it returns:</p>
<ul><li><p><code>cor</code> is the Pearson's correlation matrix of the final selected
network.</p></li>
</ul><p>When <code>minimal_output</code> is set to TRUE, these are also the only elements
returned in the object of class <code>carmon_rec</code> given by <code>reconstruct()</code>. For
the non minimal output elements, please look at <code><a href="https://drquestion.github.io/coglasso/reference/bs.html" class="external-link">coglasso::bs()</a></code> for
<code>net_method = 'coglasso'</code>. For the other three methods, look at
<code><a href="https://rdrr.io/pkg/huge/man/huge.html" class="external-link">huge::huge()</a></code> and at <code><a href="https://rdrr.io/pkg/huge/man/huge.select.html" class="external-link">huge::huge.select()</a></code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>reconstruct()</code> uses <em>collaborative graphical lasso</em> ('coglasso') as a
default engine to reconstruct the multi-omics network, as the method was
specifically developed for the multi-omics scenario. <code>carmon</code> also implements
three classic alternatives to 'coglasso': <em>graphical lasso</em>,
neighborhood selection (as designed by Meinshausen and Buhlmann), and
Pearson's correlation networks. The computational engine mainly used for
these alternative options is the <code>huge</code> R package for network reconstruction,
with a couple of small exceptions. Each one of these methods comes with its
tailored model selection procedures. For 'coglasso', for example, it is an
StARS procedure extended to the multiple hyperparameters of coglasso,
<em>XStARS</em>, while for the other methods we suggest using the traditional
<em>StARS</em> strategy.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># To reconstruct the multi-omics network, it is first necessary to copulize</span></span></span>
<span class="r-in"><span><span class="co"># the input data with copulize(), then provide the normally distributed</span></span></span>
<span class="r-in"><span><span class="co"># omics layers to reconstruct().</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">multi_omics_micro</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">copulized</span> <span class="op">&lt;-</span> <span class="fu"><a href="copulize.html">copulize</a></span><span class="op">(</span><span class="va">multi_omics_micro</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rec</span> <span class="op">&lt;-</span> <span class="fu">reconstruct</span><span class="op">(</span><span class="va">copulized</span><span class="op">$</span><span class="va">layers</span>,</span></span>
<span class="r-in"><span>    net_method <span class="op">=</span> <span class="st">"correlation"</span>,</span></span>
<span class="r-in"><span>    cor_quant <span class="op">=</span> <span class="fl">0.5</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To make a carmon object out of these two:</span></span></span>
<span class="r-in"><span><span class="va">c_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="assemble_carmon_obj.html">assemble_carmon_obj</a></span><span class="op">(</span><span class="va">copulized</span>, <span class="va">rec</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alessio Albanese, Pariya Behrouzi.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

