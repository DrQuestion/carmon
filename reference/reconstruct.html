<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Reconstruct a multi-omics network from a list of copulized layers — reconstruct • carmon</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Reconstruct a multi-omics network from a list of copulized layers — reconstruct"><meta name="description" content="Reconstruct a multi-omics network from a list of copulized layers with a
chosen network reconstruction method. The default method is
collaborative graphical regression."><meta property="og:description" content="Reconstruct a multi-omics network from a list of copulized layers with a
chosen network reconstruction method. The default method is
collaborative graphical regression."><meta property="og:image" content="https://drquestion.github.io/carmon/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">carmon</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/carmon.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DrQuestion/carmon/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Reconstruct a multi-omics network from a list of copulized layers</h1>
      <small class="dont-index">Source: <a href="https://github.com/DrQuestion/carmon/blob/main/R/reconstruct.R" class="external-link"><code>R/reconstruct.R</code></a></small>
      <div class="d-none name"><code>reconstruct.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Reconstruct a multi-omics network from a list of copulized layers with a
chosen network reconstruction method. The default method is
<em>collaborative graphical regression</em>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">reconstruct</span><span class="op">(</span></span>
<span>  <span class="va">layers</span>,</span>
<span>  net_method <span class="op">=</span> <span class="st">"coglasso"</span>,</span>
<span>  sel_method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  cor_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cor_quant <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  minimal_output <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-layers">layers<a class="anchor" aria-label="anchor" href="#arg-layers"></a></dt>
<dd><p>The omics layers to analyze. To be provided as a named R
list of data sets that have undergone the copulization treatment by the
<code><a href="copulize.html">copulize()</a></code> function. Given the output  of <code><a href="copulize.html">copulize()</a></code>, for example an
object named <code>carmon_cop</code>, it can be accessed via <code>carmon_cop$layers</code>.</p></dd>


<dt id="arg-net-method">net_method<a class="anchor" aria-label="anchor" href="#arg-net-method"></a></dt>
<dd><p>The network reconstruction method to use. The four methods
currently available are: 'coglasso' for collaborative graphical lasso,
'glasso' for graphical lasso, 'mb' for the Meinshausen-Buhlmann
neighborhood selection, and 'correlation' for a thresholded Pearson's
correlation network. The default method is 'coglasso'.</p></dd>


<dt id="arg-sel-method">sel_method<a class="anchor" aria-label="anchor" href="#arg-sel-method"></a></dt>
<dd><p>The network selection method. Each reconstruction procedure
has its own model selection procedures available. Here is the list of them:</p><ul><li><p>for <code>net_method</code> being 'coglasso': 'xstars' for eXtended StARS, 'xestars'
for eXtended  Efficient StARS, and 'ebic' for extended bayesian information
criterion. Default is 'xestars'.</p></li>
<li><p>for <code>net_method</code> being 'glasso': 'stars' for StARS, 'ric' for rotational
information criterion, and 'ebic' for for extended bayesian information
criterion. Default is 'stars'.</p></li>
<li><p>for <code>net_method</code> being 'mb' or 'correlation': 'stars' for StARS, 'ric'
for rotational information criterion. Default is 'stars'.</p></li>
</ul></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>The additional optional arguments to be given for the network
reconstruction procedure. The available arguments depend on the chosen
network reconstruction and network selection methods. If using 'coglasso'
(default option), see <code><a href="https://drquestion.github.io/coglasso/reference/bs.html" class="external-link">coglasso::bs()</a></code> for both reconstruction and
selection arguments. If reconstructing with 'glasso', 'mb', or
'correlation' without setting <code>cor_cutoff</code> or <code>cor_quant</code> see,
respectively, <code><a href="https://rdrr.io/pkg/huge/man/huge.glasso.html" class="external-link">huge::huge.glasso()</a></code>, <code><a href="https://rdrr.io/pkg/huge/man/huge.mb.html" class="external-link">huge::huge.mb()</a></code>, or
<code><a href="https://rdrr.io/pkg/huge/man/huge.ct.html" class="external-link">huge::huge.ct()</a></code>. For additional options for network selection from these
last three reconstruction methods, see <code><a href="https://rdrr.io/pkg/huge/man/huge.select.html" class="external-link">huge::huge.select()</a></code>.</p></dd>


<dt id="arg-cor-cutoff">cor_cutoff<a class="anchor" aria-label="anchor" href="#arg-cor-cutoff"></a></dt>
<dd><p>Optional for <code>net_method = 'correlation'</code>. The cutoff
value for the absolute Pearson's correlation network. Any edge with an
absolute correlation below the cutoff is excluded from the final network.
Not used by default, as the cutoff is generated by internal calculations.</p></dd>


<dt id="arg-cor-quant">cor_quant<a class="anchor" aria-label="anchor" href="#arg-cor-quant"></a></dt>
<dd><p>Optional for <code>net_method = 'correlation'</code>, to set as an
alternative to <code>cor_cutoff</code>. Determine the cutoff of correlation based on
the top percentile indicated by the user. For example, <code>cor_quant = 0.2</code>
would set as a correlation cutoff the 20th percentile of the absolute
Pearson's correlation values, ordered from highest to lowest. Not used by
default, as the cutoff is generated by internal calculations.</p></dd>


<dt id="arg-minimal-output">minimal_output<a class="anchor" aria-label="anchor" href="#arg-minimal-output"></a></dt>
<dd><p>Logical. Set to TRUE to get only a minimal output from
the <code>reconstruct()</code> function, which differs depending on the network
reconstruction method.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>The level of verbosity of the reconstruction process. <code>0</code>
suppresses the information output, while <code>1</code> and <code>2</code> give progressively
increasing amounts of information about the inner computations happening
inside <code>reconstruct()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>reconstruct()</code> returns an object of <code>S3</code> class <code>carmon_rec</code>. The
elements it contains depend on the chosen network reconstruction and
selection strategies, but the main elements are shared by all methods. <br>
These shared elements are:</p><ul><li><p><code>sel_adj</code> is the adjacency matrix of the final selected network.</p></li>
<li><p><code>net_method</code> is the chosen network reconstruction method.</p></li>
<li><p><code>sel_method</code> is the chosen model selection method.</p></li>
<li><p><code>reconstruct_call</code> is the matched call.</p></li>
</ul><p>Moreover, when choosing 'coglasso' or 'glasso' as network reconstruction
method, <code>reconstruct()</code> also returns:</p>
<ul><li><p><code>sel_icov</code> is the inverse covariance matrix of the final selected
network.</p></li>
</ul><p>Otherwise, if choosing 'correlation', it returns:</p>
<ul><li><p><code>cor</code> is the Pearson's correlation matrix of the final selected
network.</p></li>
</ul><p>When <code>minimal_output</code> is set to TRUE, these are also the only elements
returned in the object of class <code>carmon_rec</code> given by <code>reconstruct()</code>. For
the non minimal output elements, please look at <code><a href="https://drquestion.github.io/coglasso/reference/bs.html" class="external-link">coglasso::bs()</a></code> for
<code>net_method = 'coglasso'</code>. For the other three methods, look at
<code><a href="https://rdrr.io/pkg/huge/man/huge.html" class="external-link">huge::huge()</a></code> and at <code><a href="https://rdrr.io/pkg/huge/man/huge.select.html" class="external-link">huge::huge.select()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>reconstruct()</code> uses <em>collaborative graphical lasso</em> ('coglasso') as a
default engine to reconstruct the multi-omics network, as the method was
specifically developed for the multi-omics scenario. <code>carmon</code> also implements
three classic alternatives to 'coglasso': <em>graphical lasso</em>,
neighborhood selection (as designed by Meinshausen and Buhlmann), and
Pearson's correlation networks. The computational engine mainly used for
these alternative options is the <code>huge</code> R package for network reconstruction,
with a couple of small exceptions. Each one of these methods comes with its
tailored model selection procedures. For 'coglasso', for example, it is an
StARS procedure extended to the multiple hyperparameters of coglasso,
<em>XStARS</em>, while for the other methods we suggest using the traditional
<em>StARS</em> strategy.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># To reconstruct the multi-omics network, it is first necessary to copulize</span></span></span>
<span class="r-in"><span><span class="co"># the input data with copulize(), then provide the normally distributed</span></span></span>
<span class="r-in"><span><span class="co"># omics layers to reconstruct().</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">multi_omics_micro</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">copulized</span> <span class="op">&lt;-</span> <span class="fu"><a href="copulize.html">copulize</a></span><span class="op">(</span><span class="va">multi_omics_micro</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rec</span> <span class="op">&lt;-</span> <span class="fu">reconstruct</span><span class="op">(</span><span class="va">copulized</span><span class="op">$</span><span class="va">layers</span>,</span></span>
<span class="r-in"><span>    net_method <span class="op">=</span> <span class="st">"correlation"</span>,</span></span>
<span class="r-in"><span>    cor_quant <span class="op">=</span> <span class="fl">0.5</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To make a carmon object out of these two:</span></span></span>
<span class="r-in"><span><span class="va">c_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="assemble_carmon_obj.html">assemble_carmon_obj</a></span><span class="op">(</span><span class="va">copulized</span>, <span class="va">rec</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alessio Albanese, Pariya Behrouzi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

